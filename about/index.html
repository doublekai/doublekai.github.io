<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 关于我 · Doublekai的博客</title><meta name="description" content="关于我 - DOUBLEKAI"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://www.doublekai.com/atom.xml" title="Doublekai的博客"><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Doublekai的博客" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="https://ai.aiyly.com" target="_blank" class="nav-list-link">AI</a></li><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/doublekai?tab=repositories" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">关于我</h1><div class="post-info">Jan 19, 2026</div><div class="post-content"><blockquote>
<p><strong>Talk is cheap, Show me the code</strong></p>
</blockquote>
<hr>
<h2 id="个人简介"><a href="#个人简介" class="headerlink" title="个人简介"></a>个人简介</h2><p>热爱技术的全栈工程师，专注于 Web 安全、后端系统架构和 AI 应用开发。喜欢深入原理，追求代码的简洁与高效。</p>
<hr>
<h2 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h2><p><strong>后端</strong>：Node.js / Midway.js / TypeORM / MySQL / Redis</p>
<p><strong>前端</strong>：Vue / React / TypeScript (前端小白)</p>
<p><strong>AI/LLM</strong>：OpenAI SDK / Agent 开发 / Function Calling / Prompt Engineering</p>
<p><strong>运维</strong>：Docker / Nginx / SSH 隧道 / GitHub Actions</p>
<p><strong>安全</strong>：Web 安全攻防 / SQL 注入防护 / XSS 防护</p>
<hr>
<h2 id="0-1-项目经历"><a href="#0-1-项目经历" class="headerlink" title="0-1 项目经历"></a>0-1 项目经历</h2><h3 id="AI-Agent-数据分析平台"><a href="#AI-Agent-数据分析平台" class="headerlink" title="AI Agent 数据分析平台"></a>AI Agent 数据分析平台</h3><p><strong>项目简介</strong>：自然语言数据库分析平台，用户配置 MySQL 数据库连接和业务 Schema，通过自然语言提问（如”上周新增了多少用户”），系统自动理解意图、生成 SQL、执行查询并解读结果。</p>
<p><strong>技术栈</strong>：Midway.js + TypeORM + OpenAI SDK + 手写 Agent 框架</p>
<h4 id="核心架构"><a href="#核心架构" class="headerlink" title="核心架构"></a>核心架构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌─────────────────────────────────────────────────┐</span><br><span class="line">│               前端 (Vue/React)                   │</span><br><span class="line">└─────────────────────────────────────────────────┘</span><br><span class="line">                        ↓ SSE Stream</span><br><span class="line">┌─────────────────────────────────────────────────┐</span><br><span class="line">│              AgentController                     │</span><br><span class="line">│  • 接收自然语言查询                               │</span><br><span class="line">│  • 返回 SSE 流式响应                             │</span><br><span class="line">└─────────────────────────────────────────────────┘</span><br><span class="line">                        ↓</span><br><span class="line">┌─────────────────────────────────────────────────┐</span><br><span class="line">│               GAAgent (核心)                     │</span><br><span class="line">│  • 构建系统提示词（注入 Schema）                  │</span><br><span class="line">│  • 流式调用 LLM                                  │</span><br><span class="line">│  • 迭代工具调用（最多10轮）                       │</span><br><span class="line">└─────────────────────────────────────────────────┘</span><br><span class="line">                        ↓</span><br><span class="line">┌─────────────────────────────────────────────────┐</span><br><span class="line">│               Tool System                        │</span><br><span class="line">│  BaseTool → DynamicQueryTool → SQLBuilder       │</span><br><span class="line">└─────────────────────────────────────────────────┘</span><br><span class="line">                        ↓</span><br><span class="line">┌─────────────────────────────────────────────────┐</span><br><span class="line">│           用户 MySQL 数据库                      │</span><br><span class="line">│        （支持直连 / SSH 隧道连接）                │</span><br><span class="line">└─────────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure>

<h4 id="技术亮点"><a href="#技术亮点" class="headerlink" title="技术亮点"></a>技术亮点</h4><p><strong>1. 手写 Agent 框架（无依赖 LangChain）</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> *<span class="function"><span class="title">chatStream</span>(<span class="params">query: <span class="built_in">string</span>, context: IAgentContext</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> iterations = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (iterations &lt; <span class="number">10</span>) &#123;  <span class="comment">// 防止无限循环</span></span><br><span class="line">    iterations++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 流式调用 LLM</span></span><br><span class="line">    <span class="keyword">const</span> stream = <span class="keyword">await</span> <span class="built_in">this</span>.openai.chat.completions.create(&#123;</span><br><span class="line">      <span class="attr">model</span>: <span class="built_in">this</span>.model,</span><br><span class="line">      messages,</span><br><span class="line">      <span class="attr">tools</span>: openAITools,</span><br><span class="line">      <span class="attr">stream</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理流式响应，实时推送内容</span></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> chunk <span class="keyword">of</span> stream) &#123;</span><br><span class="line">      <span class="keyword">if</span> (chunk.delta.content) &#123;</span><br><span class="line">        <span class="keyword">yield</span> &#123; <span class="attr">content</span>: chunk.delta.content &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 有工具调用则执行后继续，否则返回</span></span><br><span class="line">    <span class="keyword">if</span> (toolCalls.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> result = <span class="keyword">await</span> tool.execute(args, context);</span><br><span class="line">      messages.push(&#123; <span class="attr">role</span>: <span class="string">&#x27;tool&#x27;</span>, <span class="attr">content</span>: <span class="built_in">JSON</span>.stringify(result) &#125;);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为什么不用 LangChain？</p>
<ul>
<li>轻量化：只需要 Function Calling 功能，不需要引入大量依赖</li>
<li>可控性：精确控制流式响应、错误处理、Token 统计</li>
<li>性能：减少中间层，直接调用 OpenAI SDK</li>
<li>场景适配：数据库查询场景相对固定，不需要复杂的 Chain 编排</li>
</ul>
<p><strong>2. 四层 SQL 安全防护</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">┌───────────────────────────────────────────────┐</span><br><span class="line">│              SQL 安全防护体系                  │</span><br><span class="line">├───────────────────────────────────────────────┤</span><br><span class="line">│  第一层：设计层面                              │</span><br><span class="line">│  └─ SQLBuilder 只能生成 SELECT 语句           │</span><br><span class="line">│                                               │</span><br><span class="line">│  第二层：白名单验证                            │</span><br><span class="line">│  └─ 表名/列名必须在用户配置的 Schema 中       │</span><br><span class="line">│                                               │</span><br><span class="line">│  第三层：标识符转义                            │</span><br><span class="line">│  └─ 只允许 [a-zA-Z0-9_]，反引号包裹           │</span><br><span class="line">│                                               │</span><br><span class="line">│  第四层：参数化查询                            │</span><br><span class="line">│  └─ 所有用户输入都使用 ? 占位符               │</span><br><span class="line">└───────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure>

<p><strong>3. 全链路流式响应</strong></p>
<ul>
<li>LLM 端：OpenAI SDK <code>stream: true</code></li>
<li>Agent 端：AsyncGenerator 逐步 yield</li>
<li>Controller 端：SSE 协议实时推送</li>
<li>前端：EventSource 接收，实现”逐字输出”效果</li>
</ul>
<p><strong>4. 多租户数据隔离</strong></p>
<ul>
<li>每个用户独立配置 MySQL 连接信息和业务 Schema</li>
<li>动态创建数据库连接，支持直连和 SSH 隧道</li>
<li>JWT 认证确保只能访问自己的配置</li>
</ul>
<hr>
<h3 id="SEO-内容平台（后端部分）"><a href="#SEO-内容平台（后端部分）" class="headerlink" title="SEO 内容平台（后端部分）"></a>SEO 内容平台（后端部分）</h3><p><strong>项目简介</strong>：内容发布平台后端，提供 SEO 友好的 API 设计和数据输出。</p>
<p><strong>技术栈</strong>：Midway.js + TypeORM + MySQL + Redis</p>
<h4 id="后端-SEO-技术实现"><a href="#后端-SEO-技术实现" class="headerlink" title="后端 SEO 技术实现"></a>后端 SEO 技术实现</h4><p><strong>1. 动态 Sitemap 生成接口</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span>(<span class="string">&#x27;/sitemap&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">SitemapController</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Get</span>(<span class="string">&#x27;.xml&#x27;</span>)</span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">getSitemap</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> articles = <span class="keyword">await</span> <span class="built_in">this</span>.articleService.findAll();</span><br><span class="line">    <span class="keyword">const</span> topics = <span class="keyword">await</span> <span class="built_in">this</span>.topicService.findAll();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> urls = [</span><br><span class="line">      &#123; <span class="attr">loc</span>: <span class="string">&#x27;https://www.aiyly.com/&#x27;</span>, <span class="attr">priority</span>: <span class="number">1.0</span>, <span class="attr">changefreq</span>: <span class="string">&#x27;daily&#x27;</span> &#125;,</span><br><span class="line">      ...articles.map(<span class="function"><span class="params">a</span> =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">loc</span>: <span class="string">`https://www.aiyly.com/article/<span class="subst">$&#123;a.slug&#125;</span>`</span>,</span><br><span class="line">        <span class="attr">lastmod</span>: a.updatedAt.toISOString(),</span><br><span class="line">        <span class="attr">priority</span>: <span class="number">0.8</span>,</span><br><span class="line">        <span class="attr">changefreq</span>: <span class="string">&#x27;weekly&#x27;</span>,</span><br><span class="line">      &#125;)),</span><br><span class="line">      ...topics.map(<span class="function"><span class="params">t</span> =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">loc</span>: <span class="string">`https://www.aiyly.com/topic/<span class="subst">$&#123;t.slug&#125;</span>`</span>,</span><br><span class="line">        <span class="attr">lastmod</span>: t.updatedAt.toISOString(),</span><br><span class="line">        <span class="attr">priority</span>: <span class="number">0.9</span>,</span><br><span class="line">        <span class="attr">changefreq</span>: <span class="string">&#x27;weekly&#x27;</span>,</span><br><span class="line">      &#125;)),</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.buildSitemapXml(urls);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2. 结构化数据 API 输出</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文章详情接口返回结构化数据</span></span><br><span class="line"><span class="meta">@Get</span>(<span class="string">&#x27;/:slug&#x27;</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">getArticle</span>(<span class="params"><span class="meta">@Param</span>(<span class="string">&#x27;slug&#x27;</span>) slug: <span class="built_in">string</span></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> article = <span class="keyword">await</span> <span class="built_in">this</span>.articleService.findBySlug(slug);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...article,</span><br><span class="line">    <span class="comment">// 返回 JSON-LD 结构化数据供前端使用</span></span><br><span class="line">    <span class="attr">structuredData</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@context&#x27;</span>: <span class="string">&#x27;https://schema.org&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;@type&#x27;</span>: <span class="string">&#x27;Article&#x27;</span>,</span><br><span class="line">      <span class="attr">headline</span>: article.title,</span><br><span class="line">      <span class="attr">description</span>: article.summary,</span><br><span class="line">      <span class="attr">image</span>: article.coverImage,</span><br><span class="line">      <span class="attr">datePublished</span>: article.createdAt,</span><br><span class="line">      <span class="attr">dateModified</span>: article.updatedAt,</span><br><span class="line">      <span class="attr">author</span>: &#123; <span class="string">&#x27;@type&#x27;</span>: <span class="string">&#x27;Person&#x27;</span>, <span class="attr">name</span>: article.author.name &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 返回 SEO Meta 数据</span></span><br><span class="line">    <span class="attr">seoMeta</span>: &#123;</span><br><span class="line">      <span class="attr">title</span>: article.seoTitle || article.title,</span><br><span class="line">      <span class="attr">description</span>: article.seoDescription || article.summary,</span><br><span class="line">      <span class="attr">keywords</span>: article.keywords,</span><br><span class="line">      <span class="attr">canonicalUrl</span>: <span class="string">`https://www.aiyly.com/article/<span class="subst">$&#123;slug&#125;</span>`</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3. URL 规范化处理</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 中间件：统一 URL 格式</span></span><br><span class="line"><span class="meta">@Middleware</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UrlNormalizeMiddleware</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">resolve</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">async</span> (ctx: Context, <span class="attr">next</span>: <span class="function">() =&gt;</span> <span class="built_in">Promise</span>&lt;<span class="built_in">void</span>&gt;) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> path = ctx.path;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 去除末尾斜杠（首页除外）</span></span><br><span class="line">      <span class="keyword">if</span> (path !== <span class="string">&#x27;/&#x27;</span> &amp;&amp; path.endsWith(<span class="string">&#x27;/&#x27;</span>)) &#123;</span><br><span class="line">        ctx.status = <span class="number">301</span>;</span><br><span class="line">        ctx.redirect(path.slice(<span class="number">0</span>, -<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 统一小写</span></span><br><span class="line">      <span class="keyword">if</span> (path !== path.toLowerCase()) &#123;</span><br><span class="line">        ctx.status = <span class="number">301</span>;</span><br><span class="line">        ctx.redirect(path.toLowerCase());</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">await</span> next();</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>4. 内链自动插入</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 服务层：内容渲染时自动插入内链</span></span><br><span class="line"><span class="meta">@Provide</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ContentService</span> </span>&#123;</span><br><span class="line">  <span class="keyword">async</span> renderWithInternalLinks(content: <span class="built_in">string</span>): <span class="built_in">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// 获取所有关键词和对应链接</span></span><br><span class="line">    <span class="keyword">const</span> keywords = <span class="keyword">await</span> <span class="built_in">this</span>.keywordService.findAll();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result = content;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> kw <span class="keyword">of</span> keywords) &#123;</span><br><span class="line">      <span class="comment">// 只替换第一次出现，避免过度优化</span></span><br><span class="line">      <span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`(?&lt;![\\w&gt;])<span class="subst">$&#123;<span class="built_in">this</span>.escapeRegex(kw.text)&#125;</span>(?![\\w&lt;])`</span>, <span class="string">&#x27;i&#x27;</span>);</span><br><span class="line">      result = result.replace(</span><br><span class="line">        regex,</span><br><span class="line">        <span class="string">`&lt;a href=&quot;<span class="subst">$&#123;kw.url&#125;</span>&quot; title=&quot;<span class="subst">$&#123;kw.text&#125;</span>&quot;&gt;<span class="subst">$&#123;kw.text&#125;</span>&lt;/a&gt;`</span></span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>5. 缓存策略</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Redis 缓存热门内容</span></span><br><span class="line"><span class="meta">@Provide</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleService</span> </span>&#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">findBySlug</span>(<span class="params">slug: <span class="built_in">string</span></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> cacheKey = <span class="string">`article:<span class="subst">$&#123;slug&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 先查缓存</span></span><br><span class="line">    <span class="keyword">const</span> cached = <span class="keyword">await</span> <span class="built_in">this</span>.redis.get(cacheKey);</span><br><span class="line">    <span class="keyword">if</span> (cached) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">JSON</span>.parse(cached);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查数据库</span></span><br><span class="line">    <span class="keyword">const</span> article = <span class="keyword">await</span> <span class="built_in">this</span>.articleRepo.findOne(&#123; <span class="attr">where</span>: &#123; slug &#125; &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入缓存，1 小时过期</span></span><br><span class="line">    <span class="keyword">await</span> <span class="built_in">this</span>.redis.setex(cacheKey, <span class="number">3600</span>, <span class="built_in">JSON</span>.stringify(article));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> article;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="技术理解"><a href="#技术理解" class="headerlink" title="技术理解"></a>技术理解</h2><h3 id="Agent-vs-传统-LLM"><a href="#Agent-vs-传统-LLM" class="headerlink" title="Agent vs 传统 LLM"></a>Agent vs 传统 LLM</h3><table>
<thead>
<tr>
<th>模式</th>
<th>流程</th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td>传统 LLM</td>
<td>提问 → 回答 → 结束</td>
<td>只能基于训练数据</td>
</tr>
<tr>
<td>Agent</td>
<td>提问 → 思考 → 调用工具 → 获取结果 → 继续思考 → 最终回答</td>
<td>可连接真实数据</td>
</tr>
</tbody></table>
<h3 id="SSE-vs-WebSocket"><a href="#SSE-vs-WebSocket" class="headerlink" title="SSE vs WebSocket"></a>SSE vs WebSocket</h3><table>
<thead>
<tr>
<th>特性</th>
<th>SSE</th>
<th>WebSocket</th>
</tr>
</thead>
<tbody><tr>
<td>方向</td>
<td>单向（服务器→客户端）</td>
<td>双向</td>
</tr>
<tr>
<td>协议</td>
<td>HTTP</td>
<td>独立协议</td>
</tr>
<tr>
<td>复杂度</td>
<td>简单</td>
<td>较复杂</td>
</tr>
<tr>
<td>适用场景</td>
<td>流式输出、推送通知</td>
<td>聊天、游戏</td>
</tr>
</tbody></table>
<p>选择 SSE：Agent 响应是单向的，不需要双向通信，实现更简单。</p>
<hr>
<h2 id="爱好"><a href="#爱好" class="headerlink" title="爱好"></a>爱好</h2><ul>
<li>篮球</li>
<li>户外</li>
<li>象棋</li>
</ul>
<hr>
<h2 id="联系方式"><a href="#联系方式" class="headerlink" title="联系方式"></a>联系方式</h2><ul>
<li><strong>Email</strong>: <a href="mailto:&#119;&#100;&#x6f;&#117;&#98;&#108;&#101;&#x6b;&#x61;&#105;&#64;&#49;&#50;&#54;&#x2e;&#99;&#x6f;&#109;">&#119;&#100;&#x6f;&#117;&#98;&#108;&#101;&#x6b;&#x61;&#105;&#64;&#49;&#50;&#54;&#x2e;&#99;&#x6f;&#109;</a></li>
<li><strong>微信</strong>: wdoublekai</li>
<li><strong>博客</strong>: <a target="_blank" rel="noopener" href="https://www.aiyly.com/">www.aiyly.com</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"></div><div class="copyright"><p>© 2015 - 2026 DOUBLEKAI</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>